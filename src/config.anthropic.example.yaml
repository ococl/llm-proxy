listen: ":8080"

proxy_api_key: "sk-your-unified-api-key"

proxy:
  enable_system_prompt: false
  forward_client_ip: true

# 后端配置示例
backends:
  # OOCC 后端 - 使用 Anthropic 原生协议
  - name: "oocc-anthropic"
    url: "https://your-oocc-endpoint.com/v1"
    api_key: "sk-ant-oocc-xxx"
    protocol: "anthropic"  # 关键配置：指定使用 Anthropic 协议
    enabled: true

  # 备用 OpenAI 后端
  - name: "openai-backup"
    url: "https://api.openai.com/v1"
    api_key: "sk-openai-xxx"
    # protocol: "openai"  # 可省略，默认就是 openai
    enabled: false

# 模型路由配置
models:
  # Claude 模型通过 OOCC 访问（使用 Anthropic 协议）
  "anthropic/claude-sonnet-4":
    routes:
      - backend: "oocc-anthropic"
        model: "claude-sonnet-4-20250514"
        priority: 1

  "anthropic/claude-opus-4":
    routes:
      - backend: "oocc-anthropic"
        model: "claude-opus-4-20250514"
        priority: 1

  # 如果需要在同一后端混合使用不同协议，可以在模型级别覆盖
  "openai/gpt-4o":
    enabled: false
    routes:
      - backend: "oocc-anthropic"
        model: "gpt-4o"
        protocol: "openai"  # 模型级别覆盖后端的 anthropic 协议
        priority: 1

# 故障转移配置
fallback:
  cooldown_seconds: 300
  max_retries: 3
  alias_fallback:
    "anthropic/claude-sonnet-4":
      - "anthropic/claude-opus-4"

# 错误检测规则
detection:
  error_codes: ["4xx", "5xx"]
  error_patterns:
    - "insufficient_quota"
    - "rate_limit"
    - "exceeded"
    - "billing"
    - "quota"
    - "organization has been disabled"

# 日志配置
logging:
  level: "info"
  console_level: "info"
  base_dir: "./logs"
  max_file_size_mb: 100
  max_age_days: 7
  max_backups: 21
  compress: true
  format: "json"
  colorize: true
  console_style: "compact"
  console_format: "markdown"
  debug_mode: true
  async: true
  buffer_size: 10000
  flush_interval: 5
  drop_on_full: false
  rotate_by_size: true
  rotate_by_time: false
  time_rotation: "daily"
  mask_sensitive: true
  detailed_masking: false

